<div mat-dialog-title>
    <div fxLayout="row" fxLayoutAlign="start center">
        <!-- TODO: Link to collection -->
        <ng-container *ngIf='(collection$ | async) as collection'>
            <div>
                <img id="collection-icon" *ngIf="collection.icon" [src]="collection.icon" alt="collection icon">
            </div>
            <div>
                <h2>
                    {{ collection.collectionName }}
                </h2>
            </div>
        </ng-container>
        <div class="ml-auto">
            <button *ngIf='canEdit | async' class="btn-icon" (click)="onEditClick()">
                <mat-icon>create</mat-icon>
            </button>
            <button class="btn-icon" (click)="onCloseClick()">
                <mat-icon>close</mat-icon>
            </button>
        </div>
    </div>
</div>
<ng-container *ngIf='(occurrence$ | async) as occurrence'>
    <div mat-dialog-content *ngIf='isEditing; else viewing'>
        <symbiota2-occurrence-editor
            [occurrence]='occurrence'
        >
        </symbiota2-occurrence-editor>
    </div>
    <ng-template #viewing>
        <div mat-dialog-content fxLayout="column">
            <div class="edit-category">
                <symbiota2-expansion-panel label="Collector info" expanded="true">
                    <ng-container *ngFor="let item of occurrence.collectorInfo() | keyvalue">
                        <p *ngIf="item.value">
                            <b>{{ getI18nForField(item.key) | async }}:</b> {{ item.value }}
                        </p>
                    </ng-container>
                </symbiota2-expansion-panel>
            </div>
            <div class="edit-category">
                <symbiota2-expansion-panel label="Latest identification">
                    <ng-container *ngFor="let item of occurrence.latestIDInfo() | keyvalue">
                        <p *ngIf="item.value">
                            <b>{{ getI18nForField(item.key) | async }}:</b> {{ item.value }}
                        </p>
                    </ng-container>
                </symbiota2-expansion-panel>
            </div>
            <small id="footer" *ngIf="occurrence.lastModifiedTimestamp">
                Last updated {{ occurrence.lastModifiedTimestamp | date }}
            </small>
        </div>
    </ng-template>
</ng-container>

