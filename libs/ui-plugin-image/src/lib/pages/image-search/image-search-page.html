<div id="main">
    <div>
        <h1>{{"image.search.title" | translate}}</h1>
    </div>

    <!-- Configure search options -->
<!--
    <div class="expansion-panel">
        <symbiota2-expansion-panel expanded=false label='{{"image.search.options.label" | translate}}' >
            <mat-checkbox class="example-margin" [(ngModel)]='needIdentification'>
                {{"image.search.checkbox.label.need.identification" | translate}}
            </mat-checkbox>
            <br/>
            <mat-checkbox class="example-margin" [(ngModel)]='includeLowQuality'>
                {{"image.search.checkbox.label.low.quality" | translate}}
            </mat-checkbox>
            <br/>
            <mat-checkbox class="example-margin" [(ngModel)]='atLevelOfSpecies'>
                {{"image.search.checkbox.label.to.species" | translate}}
            </mat-checkbox>
        </symbiota2-expansion-panel>
    </div>
-->

<!--
    <h4>{{"image.search.search.terms" | translate}}</h4>

    <div class="expansion-panel">
        <symbiota2-expansion-panel expanded=false label='{{"image.search.by.name" | translate}}'>

            <div class="expansion-panel">
                <symbiota2-expansion-panel expanded=false label='{{"taxonomy.viewer.configure.label" | translate}}'>

                    <mat-form-field appearance="fill">
                        <mat-label>{{"taxonomy.viewer.label.authority" | translate}}</mat-label>
                        <mat-select field-class="symbiota2-field-class"
                                    placeholder='{{"taxonomy.viewer.label.authority" | translate}}'
                                    [(value)]="taxonomicAuthorityID"
                                    (selectionChange)="authorityChangeAction()">
                            <mat-option *ngFor="let authority of taxonomicAuthorityList"
                                        [value]="authority.id" >{{ authority.name }}</mat-option>
                        </mat-select>
                    </mat-form-field>

                    <mat-checkbox
                        class="example-margin"
                        [(ngModel)]='hasAuthors'
                    >
                        {{"taxonomy.viewer.label.checkbox.authors" | translate}}
                    </mat-checkbox>

                </symbiota2-expansion-panel>
            </div>

            <form class="name-autocomplete-form" (ngSubmit)="onSubmit()">
                <mat-form-field class="name-autocomplete-full-width">
                    <mat-label >{{"taxonomy.viewer.label.name.scientific" | translate}}</mat-label>

                    <input type="text"
                           placeholder='{{"taxonomy.viewer.label.name.scientific" | translate}}'
                           aria-label="String"
                           matInput
                           (keyup)="onKey($event)"
                           [formControl]="nameControl"
                           [matAutocomplete]="auto">

                    <mat-autocomplete autoActiveFirstOption #auto="matAutocomplete">
                        <mat-option *ngFor="let option of nameOptions" [value]="nameFor(option)">
                            {{nameFor(option)}} <small>{{authorFor(option)}}</small>
                        </mat-option>

                    </mat-autocomplete>

                </mat-form-field>
                <mat-label *ngIf="looking && !nameFound" style='color:red'>
                    <b>{{"taxonomy.viewer.name.error" | translate}}</b>
                    <br/>
                </mat-label>
                <button class="button" type="submit">{{"taxonomy.viewer.label.taxonomy" | translate}}</button>
            </form>
            <br/>
            <mat-checkbox class="example-margin" [(ngModel)]='includeAuthors'>{{"taxonomy.viewer.label.checkbox.include.authors" | translate}}</mat-checkbox>

            <symbiota2-expansion-panel
                *ngIf='possibleTaxons.length > 1'
                label='{{"taxonomy.viewer.label.choose.taxon" | translate}}'
            >
                <mat-selection-list
                    #names
                    (selectionChange)="nameListChange(names.selectedOptions.selected)"
                    [multiple]="false"
                >
                    <mat-list-option *ngFor="let txn of possibleTaxons" [value]="txn.taxonID">
                        {{txn.name}} {{txn.author}}
                    </mat-list-option>
                </mat-selection-list>
            </symbiota2-expansion-panel>

        </symbiota2-expansion-panel>
    </div>
-->
    <!--
    <div class="expansion-panel">
        <symbiota2-expansion-panel expanded=false label='{{"image.search.by.photographer" | translate}}'>
            <mat-selection-list
                #photographers
                (selectionChange)="photographerListChange(photographers.selectedOptions.selected)"
                [multiple]="false"
            >
                <mat-list-option *ngFor="let photographer of photographerOptions" [value]="photographer">
                    {{photographer}}
                </mat-list-option>
            </mat-selection-list>
        </symbiota2-expansion-panel>
    </div>

    <div class="expansion-panel">
        <symbiota2-expansion-panel expanded=false label='{{"image.search.by.country" | translate}}'>
            <mat-selection-list
                #countries
                (selectionChange)="countryListChange(countries.selectedOptions.selected)"
                [multiple]="false"
            >
                <mat-list-option *ngFor="let country of countryOptions" [value]="country.id">
                    {{country.countryTerm}}
                </mat-list-option>
            </mat-selection-list>
        </symbiota2-expansion-panel>
    </div>

<div class="expansion-panel">
<symbiota2-expansion-panel expanded=false label='{{"image.search.by.tag.keys" | translate}}'>

    <mat-selection-list
        #tagKeys
        (selectionChange)="tagKeyListChange(tagKeys.selectedOptions.selected)"
        [multiple]="true"
    >
        <mat-list-option *ngFor="let tagKey of tagKeyOptions" [value]="tagKey.tagKey">
            {{tagKey.descriptionEn}}
        </mat-list-option>
    </mat-selection-list>





        </symbiota2-expansion-panel>
           </div>
    -->

    <div>
        <mat-form-field appearance="fill">
            <mat-label >{{"image.search.by.scientific.name" | translate}}</mat-label>
            <!-- (keypress)="onKey($event)" -->
            <input type="text"
                   placeholder='{{"image.search.by.scientific.name" | translate}}'
                   aria-label="String"
                   matInput
                   (keyup)="onKey($event)"
                   [formControl]="nameControl"
                   [matAutocomplete]="auto">

            <mat-autocomplete autoActiveFirstOption #auto="matAutocomplete">
                <mat-option *ngFor="let option of nameOptions" [value]="option.name">
                    {{nameFor(option.name)}} <small>{{authorFor(option.name)}}</small>
                </mat-option>

            </mat-autocomplete>

        </mat-form-field>
        <mat-label *ngIf="looking && !nameFound" style='color:red'>
            <b>{{"taxonomy.viewer.name.error" | translate}}</b>
            <br/>
        </mat-label>
        &nbsp;&nbsp;
        <mat-form-field appearance="fill">
            <mat-label>{{"image.search.by.countries" | translate}}</mat-label>
            <mat-select [formControl]="countryForm" multiple>
                <mat-option
                    *ngFor="let country of countryOptions"
                    [value]="country.countryTerm"
                >{{country.countryTerm}}
                </mat-option>
            </mat-select>
        </mat-form-field>
        &nbsp;&nbsp;
        <mat-form-field appearance="fill">
            <mat-label>{{"image.search.by.state.provinces" | translate}}</mat-label>
            <mat-select [formControl]="stateProvinceForm" multiple>
                <mat-option
                    *ngFor="let state of stateProvinceOptions"
                    [value]="state.stateTerm"
                >{{state.stateTerm}}
                </mat-option>
            </mat-select>
        </mat-form-field>
        &nbsp;&nbsp;
        <mat-form-field appearance="fill">
            <mat-label>{{"image.search.by.tag.keys" | translate}}</mat-label>
            <mat-select [formControl]="tagKeyForm" multiple>
                <mat-option *ngFor="let tagKey of tagKeyOptions" [value]="tagKey.tagKey">{{tagKey.descriptionEn}}</mat-option>
            </mat-select>
        </mat-form-field>
        &nbsp;&nbsp;
        <mat-form-field appearance="fill">
            <mat-label>{{"image.search.by.photographers" | translate}}</mat-label>
            <mat-select [formControl]="photographerForm" multiple>
                <mat-option *ngFor="let photographer of photographerOptions" [value]="photographer">{{photographer}}</mat-option>
            </mat-select>
        </mat-form-field>
        &nbsp;&nbsp;
        <mat-form-field appearance="fill">
            <mat-label>{{"image.search.by.image.type" | translate}}</mat-label>
            <mat-select [formControl]="imageTypeForm" multiple>
                <mat-option *ngFor="let type of imageTypeOptions" [value]="type">{{type}}</mat-option>
            </mat-select>
        </mat-form-field>

        <br/>
        <button
            mat-raised-button
            color="primary"
            type="submit"
            (click)="onSubmit()"
        >
            {{"image.search.search.button" | translate}}
        </button>
        &nbsp;&nbsp;
        <button
            mat-raised-button
            color="secondary"
            type="submit"
            (click)="onClear()"
        >
            {{"image.search.clear.button" | translate}}
        </button>
    </div>

    <div *ngIf='nameControl.value || countryForm.value?.length > 0 || stateProvinceForm.value?.length > 0 || imageTypeForm.value?.length > 0 || tagKeyForm.value?.length > 0 || photographerForm.value?.length > 0'>
        <br/>
        <br/>
        <h1>{{"image.search.search.terms" | translate}}</h1>
        <ul *ngIf='nameControl.value'>
            {{"image.search.scientific.name" | translate}}: {{nameControl.value.name}}
        </ul>
        <ul *ngIf='countryForm.value?.length > 0'>
            {{"image.search.countries" | translate}}: {{countryForm.value.join(", ")}}
        </ul>
        <ul *ngIf='stateProvinceForm.value?.length > 0'>
            {{"image.search.state.provinces" | translate}}: {{stateProvinceForm.value.join(", ")}}
        </ul>
        <ul *ngIf='imageTypeForm.value?.length > 0'>
            {{"image.search.image.types" | translate}}: {{imageTypeForm.value.join(", ")}}
        </ul>
        <ul *ngIf='tagKeyForm.value?.length > 0'>
            {{"image.search.tag.keys" | translate}}: {{tagKeyForm.value.join(", ")}}
        </ul>
        <ul *ngIf='photographerForm.value?.length > 0'>
            {{"image.search.photographers" | translate}}: {{photographerForm.value.join(", ")}}
        </ul>
    </div>

    <br/>
    <br/>
    <div *ngIf='submitted && !data2'>
        <h1>{{"image.search.none.found" | translate}}</h1>
    </div>
    <div *ngIf='submitted && data2?.length > 0'>
        <h1>{{"image.search.found.images" | translate}}</h1>
        <div fxFill fxLayout="column" fxLayoutAlign="space-between">

        <mat-grid-list cols='{{data.length > 5? 5 : data.length}}' rowHeight='150px' gutterSize='5'>
            <mat-grid-tile  *ngFor="let image of data">
                <a [routerLink]="['/image/details', image.id]" target="_blank" class='imagelink'>
                    <img height="100" [src]="image.url">
                </a>
                <mat-grid-tile-footer style='background-color:white'>
                    <div fxLayout="row" fxLayoutAlign="center center">
                    <a [routerLink]="['/image/details', image.id]" target="_blank" style='text-align:center'>
                        <i style='text-align:center'>{{image.taxon?.scientificName}}</i>
                    </a>
                    </div>
                </mat-grid-tile-footer>
            </mat-grid-tile>
        </mat-grid-list>


    <!--
<div fxLayout="row wrap">

<span style='text-align:center'>
<ng-container *ngFor="let image of data">
<a [routerLink]="['/image/details', image.id]" target="_blank" class='imagelink'>
 <img height="100" [src]="image.url">&nbsp;&nbsp;
</a>
{{image.taxon?.scientificName}}
</ng-container>
</span>


</div>
-->
    <mat-paginator [length]="data2.length"
                   [pageSize]="size"
                   [pageIndex]="page"
                   [pageSizeOptions]="pageSizeOptions"
                   (page)="getData($event)">
    </mat-paginator>
</div>
</div>

</div>
